"""
get_presentation_slide_guidelines tool for Execution Agent (presentation-assistant skill).

Returns structured guidelines for creating McKinsey-style presentation slides so the model
can apply them when using generate_powerpoint or generate_chart_image.
"""

from strands import tool

_GUIDELINES = """# プレゼン資料・スライド作成ガイドライン

## スライドの基本
- **アクションタイトル**: 各スライドのタイトルは「結論を述べる1文」（約15語以内）。スライドのメッセージがタイトルだけで伝わるようにする。例: 「新興国は2027年までに120億ドルの市場となり、35%成長が見込まれる」
- **1スライド1メッセージ**: 1枚で伝えるメッセージは1つ。すべての要素がそのメッセージを支えるようにする
- **視覚はミニマル**: 装飾を避け、黒字・白背景を基本。強調は青系1色に統一。緑=正/増、赤=負/減、グレー=補足に限定

## グラフの選び方
- **構成比較**（割合・内訳）: 円グラフ、または積み上げ棒
- **項目比較**（ランキング・対比）: 横棒グラフ（大きさ順）
- **時系列**（期間ごとの変化）: 縦棒または折れ線
- **相関**（2変数の関係）: 散布図・バブル
- 軸はゼロ起点（縦棒は特に）。単位・軸ラベルを必ず付ける。重要な数値はグラフ上に直接ラベルする

## スライド構成（5部構成）
1. **表紙**: タイトル・クライアント/会社名・日付のみ（10語以内）
2. **エグゼクティブサマリ**: 1–2枚で全体の結論と3–4の要点
3. **本論**: 3–4セクション。各セクションは区切りスライド＋証拠スライド5–7枚。1スライド1メッセージ
4. **結論・推奨**: やるべきこと・担当・期限・成果・リソースを具体的に
5. ** appendix**: 補足データ・計算・Q&A用

## generate_powerpoint / generate_chart_image を使うとき
- 各スライドの title には上記のアクションタイトル（結論の1文）を入れる
- チャートが必要なメッセージでは、比較の種類に合わせて上記のグラフ種を選ぶ
- 色は最小限。データラベル・出所を忘れずに指定する"""


@tool
def get_presentation_slide_guidelines() -> str:
    """経営層向けプレゼン資料（スライド）を作成する際のデザイン・構成・グラフ選定のルールを返します。

    ユーザーが「この内容でスライドを作って」「プレゼン用にまとめて」「資料をパワポで」などと依頼した場合に、
    このツールでガイドラインを取得し、そのルールに沿って generate_powerpoint または generate_chart_image を
    呼び出してください。既存の文書やデータをスライド化する場合も、まず構成を1スライド1メッセージで整理してから作成してください。

    Returns:
        スライドのアクションタイトル・1枚1メッセージ・グラフ選定・5部構成のガイドラインテキスト。
    """
    return _GUIDELINES.strip()
