# A2A Response Extension: File Artifact
# Execution Agent が Verification Agent に返す「生成ファイル」用 artifact 定義
# 013 の execution_response artifact に加え、本 artifact が 0 または 1 個付与される

name: "A2A File Artifact (014)"
description: "Execution → Verification の A2A result.artifacts に追加する generated_file の形式"
version: "1.0.0"

---
# A2A JSON-RPC 2.0 Response（ファイル付きの例）

# 既存: result.artifacts[0] = execution_response (text)
# 追加: result.artifacts[1] = generated_file (file) （0 または 1 個）

artifacts:
  - name: "execution_response"
    description: "既存。status, channel, thread_ts, bot_token, response_text 等の JSON 文字列"
    parts:
      - kind: "text"
        text: "JSON-encoded ExecutionResponse"

  - name: "generated_file"
    description: "014 で追加。1 レスポンスあたり 0 または 1 個"
    parts:
      - kind: "file"
        # プロトコルで file の表現が定まっていない場合のフォールバック:
        # 同じ artifact 内に text で JSON を入れ、content_base64, file_name, mime_type を渡す方式も可
        contentBase64: "string (Base64-encoded file content)"
        fileName: "string (e.g. export.csv)"
        mimeType: "string (e.g. text/csv, application/json)"

---
# フォールバック案: file part が未定義な場合
# generated_file artifact の parts を kind: "text" の 1 つとし、次の JSON を入れる:

fallback_text_part_schema:
  description: "kind: file がランタイムで未サポートの場合の代替"
  content:
    content_base64: "string"
    file_name: "string"
    mime_type: "string"

---
# 制約（検証用）

constraints:
  max_file_size_bytes: 5242880   # 5 MB
  allowed_mime_types:
    - "text/csv"
    - "application/json"
    - "text/plain"
  max_artifacts_per_response: 2  # execution_response + generated_file
